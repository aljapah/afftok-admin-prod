%%{init: {'theme': 'dark'}}%%
flowchart TB
    subgraph L1["ğŸŒ Layer 1: Transport"]
        TLS["TLS 1.3"]
        HSTS["HSTS Headers"]
        Cookies["Secure Cookies"]
    end

    subgraph L2["ğŸ”’ Layer 2: Edge"]
        WAF["WAF Rules"]
        DDoS["DDoS Protection"]
        RateLimit["Rate Limiting"]
    end

    subgraph L3["ğŸ” Layer 3: Application"]
        JWT["JWT Authentication"]
        HMAC["HMAC Signatures"]
        APIKey["API Key Hashing<br/>(Argon2id)"]
        Input["Input Validation"]
        Replay["Replay Protection"]
    end

    subgraph L4["ğŸ›¡ï¸ Layer 4: Data"]
        Encrypt["Encryption at Rest"]
        Transit["Encryption in Transit"]
        Audit["Audit Logging"]
        Tenant["Tenant Isolation"]
    end

    subgraph Headers["ğŸ“‹ Security Headers"]
        CSP["Content-Security-Policy"]
        XFrame["X-Frame-Options"]
        XContent["X-Content-Type-Options"]
        XSS["X-XSS-Protection"]
    end

    Request["ğŸ“¥ Request"] --> L1
    L1 --> L2
    L2 --> L3
    L3 --> L4
    L4 --> Response["ğŸ“¤ Response"]
    
    L3 --> Headers

