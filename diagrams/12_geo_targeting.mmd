%%{init: {'theme': 'dark'}}%%
flowchart TB
    subgraph Offer["ğŸ“¢ Offer Configuration"]
        Target["ğŸ¯ Target Countries<br/>SA, AE, KW"]
        Blocked["ğŸš« Blocked Countries<br/>IR, SY"]
    end

    subgraph Promoter["ğŸ‘¤ Promoter"]
        Country["ğŸ“ User Country<br/>SA"]
        Audience["ğŸ‘¥ Audience Countries<br/>SA, AE, BH"]
    end

    subgraph Click["ğŸ–±ï¸ Click Event"]
        IP["IP: 178.23.45.67"]
        GeoIP["ğŸŒ GeoIP Service"]
        ClickCountry["Country: SA"]
    end

    subgraph Rules["âš–ï¸ Geo Rules Engine"]
        Check1["Is promoter country in target?"]
        Check2["Is promoter country blocked?"]
        Check3["Does audience match target?"]
        Check4["Is click country allowed?"]
    end

    subgraph Result["ğŸ“¤ Result"]
        Show["âœ… Show Offer"]
        Hide["âŒ Hide Offer"]
        Allow["âœ… Track Click"]
        Block["âŒ Block Click"]
    end

    Target --> Check1
    Blocked --> Check2
    Country --> Check1 & Check2
    Audience --> Check3
    
    IP --> GeoIP --> ClickCountry --> Check4

    Check1 -->|Yes| Check2
    Check2 -->|No| Check3
    Check3 -->|Match| Show
    Check3 -->|No Match| Hide

    Check4 -->|In Target| Allow
    Check4 -->|In Blocked| Block

